<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>CorreQ ¬∑ Solicitud de Mantenimiento</title>
<style>
  /* Reset y base */
  * { box-sizing: border-box; margin: 0; padding: 0; }
  html,body { height:100%; }
  body {
    font-family: "Inter", "Segoe UI", Arial, sans-serif;
    background: linear-gradient(180deg,#041428 0%, #061c36 60%);
    color: #0f1724;
    -webkit-font-smoothing:antialiased;
    -moz-osx-font-smoothing:grayscale;
    padding: 2rem 1rem;
  }
  /* particles */
  #particles-js { position: fixed; inset:0; z-index: -1; }

  /* contenedor */
  .wrap { max-width: 1060px; margin: 0 auto; }

  /* encabezado */
  header.appbar {
    display:flex; align-items:center; justify-content:space-between;
    background: rgba(6,30,60,0.35); padding:14px 18px; border-radius:10px;
    margin-bottom:18px; box-shadow: 0 6px 18px rgba(2,6,23,0.45);
    backdrop-filter: blur(4px);
  }
  .brand { display:flex; gap:12px; align-items:center; color:#fff; text-decoration:none; }
  .brand img{ height:44px; width:auto; display:block; }
  .brand h1 { font-size:1.05rem; color:#cfeefd; font-weight:700; }
  .brand p { margin-top:2px; font-size:0.82rem; color:#a9d9ef; }

  /* formulario tarjeta */
  .card {
    background: rgba(255,255,255,0.96);
    border-radius:12px;
    padding:18px;
    box-shadow: 0 10px 30px rgba(2,6,23,0.35);
    color: #042033;
  }

  .title-row { display:flex; justify-content:space-between; align-items:center; gap:12px; margin-bottom:12px; }
  .title-row h2 { color:#064a75; font-size:1.15rem; }
  .subtitle { color:#3b82f6; font-size:0.86rem; font-weight:600; }

  .progress-bar { height:8px; background:#e6eef6; border-radius:999px; overflow:hidden; margin:12px 0; }
  .progress { height:100%; width:0; background: linear-gradient(90deg,#06b6d4,#2563eb); transition: width .2s ease; }

  label { display:block; font-weight:600; font-size:0.95rem; margin-top:10px; color:#073046; }
  .hint { font-size:0.82rem; color:#6b8ca1; margin-top:6px; }

  input[type="text"], input[type="email"], input[type="file"], select, textarea {
    width:100%; padding:10px 12px; margin-top:6px; border-radius:8px; border:1px solid #dbeaf6;
    background:#fff; color:#042033; font-size:0.95rem;
  }
  input[readonly] { background:#f3f9ff; color:#244b63; }

  textarea { min-height:90px; resize:vertical; }

  .row { display:flex; gap:12px; margin-top:6px; }
  .col { flex:1; }

  .card-section { background: rgba(6,30,60,0.03); padding:10px; border-radius:8px; margin-top:12px; }

  .controls { display:flex; gap:10px; align-items:center; margin-top:14px; }
  .btn {
    padding:10px 16px; border-radius:999px; font-weight:700; cursor:pointer; border:none;
  }
  .btn.primary { background: linear-gradient(90deg,#06b6d4,#2563eb); color:#fff; box-shadow:0 8px 20px rgba(37,99,235,0.12); }
  .btn.ghost { background:transparent; color:#064a75; border:1px solid #dbeaf6; }

  .small { font-size:0.82rem; color:#375b76; }

  footer { margin-top:18px; color:#6b8ca1; text-align:center; font-size:0.85rem; }

  /* modal */
  .modal { position:fixed; inset:0; display:none; background:rgba(2,6,23,0.55); z-index:80; align-items:center; justify-content:center; padding:16px; }
  .modal .box { background:#f8fdff; padding:18px; border-radius:10px; width:100%; max-width:520px; text-align:center; color:#042033; box-shadow:0 12px 36px rgba(2,6,23,0.25); }
  .modal h3 { color:#06b6d4; margin-bottom:8px; }

  /* validacion */
  .invalid { outline: 2px solid rgba(255,72,66,0.18); box-shadow: 0 0 0 3px rgba(255,72,66,0.04); }

  @media (max-width:820px) {
    .row{ flex-direction:column; }
    .wrap { padding: 0 8px; }
  }
</style>
</head>
<body>
  <div id="particles-js"></div>

  <div class="wrap">
    <header class="appbar">
      <a class="brand" href="#">
        <!-- Reemplace por su logo real -->
        <img src="Logo-Interconsultas-01b-500px.png" alt="Logo CorreQ">
        <div>
          <h1>CorreQ ¬∑ Solicitudes de Mantenimiento</h1>
          <p>Formulario r√°pido para reportes locativos y biom√©dicos</p>
        </div>
      </a>
      <div style="text-align:right;color:#cfeefd">
        <div style="font-weight:700">IPS Interconsultas</div>
        <div style="font-size:0.82rem;color:#a8d9ee">R√°pido ¬∑ Claro ¬∑ Profesional</div>
      </div>
    </header>

    <main class="card" role="main" aria-labelledby="formTitle">
      <div class="title-row">
        <div>
          <h2 id="formTitle">üìã Solicitud a Mantenimiento</h2>
          <div class="subtitle">Llene solo lo esencial ‚Äî el formulario es din√°mico y r√°pido</div>
        </div>
        <div class="small">ID: <span id="idNote">-</span></div>
      </div>

      <div class="progress-bar" aria-hidden><div id="progress" class="progress"></div></div>

      <form id="reporteForm" enctype="multipart/form-data">
        <!-- DATOS B√ÅSICOS -->
        <div class="card-section" aria-labelledby="datosBasicos">
          <label for="idReporte">ID del reporte</label>
          <input type="text" id="idReporte" name="idReporte" readonly>

          <div class="row">
            <div class="col">
              <label for="fecha">Fecha</label>
              <input type="text" id="fecha" name="fecha" readonly>
            </div>
            <div class="col">
              <label for="hora">Hora</label>
              <input type="text" id="hora" name="hora" readonly>
            </div>
          </div>

          <label for="nombre">Nombre completo <span style="color:#ff4a42">*</span></label>
          <input type="text" id="nombre" name="nombre" autocomplete="name" required placeholder="Ej: Juan Manuel Correa">

          <div class="row">
            <div class="col">
              <label for="tipo_reporte">El reporte se relaciona con <span style="color:#ff4a42">*</span></label>
              <select id="tipo_reporte" name="tipo_reporte" required>
                <option value="">Seleccione...</option>
                <option value="infraestructura">Infraestructura</option>
                <option value="equipo_medico">Equipo m√©dico</option>
              </select>
              <div class="hint">Elija la opci√≥n que mejor describa la novedad</div>
            </div>
            <div class="col">
              <label for="email">Correo electr√≥nico (opcional)</label>
              <input type="email" id="email" name="email" placeholder="ejemplo@interconsultas.com">
            </div>
          </div>
        </div>

        <!-- INFRAESTRUCTURA: campos m√≠nimos y accesibles -->
        <div id="section_infra" class="card-section" style="display:none;">
          <label class="small" style="font-weight:700">Secci√≥n: Infraestructura (r√°pido)</label>

          <div class="row">
            <div class="col">
              <label for="area_infra">√Årea espec√≠fica <span style="color:#ff4a42">*</span></label>
              <select id="area_infra" name="area_infra">
                <option value="">Seleccione...</option>
                <option>Laboratorio</option>
                <option>Enfermer√≠a</option>
                <option>Consulta externa</option>
                <option>Odontolog√≠a</option>
                <option>Administraci√≥n</option>
                <option>Atenci√≥n Al Usuario</option>
                <option>√Åreas Comunes</option>
              </select>
            </div>

            <div class="col">
              <label for="sede_infra">Sede <span style="color:#ff4a42">*</span></label>
              <select id="sede_infra" name="sede_infra">
                <option value="">Seleccione...</option>
                <option>Sede 1</option>
                <option>Sede 2</option>
                <option>Sede 3</option>
                <option>Sede 4</option>
                <option>Sede 5</option>
              </select>
            </div>
          </div>

          <label for="ubicacion_infra">Ubicaci√≥n espec√≠fica <span style="color:#ff4a42">*</span></label>
          <select id="ubicacion_infra" name="ubicacion_infra">
            <option value="">Seleccione la ubicaci√≥n...</option>
            <!-- Cargado din√°micamente -->
          </select>

          <div class="row">
            <div class="col">
              <label for="prioridad_infra">Prioridad</label>
              <select id="prioridad_infra" name="prioridad_infra">
                <option value="">Seleccione...</option>
                <option>Urgente (6 h)</option>
                <option>Prioritario (48 h)</option>
                <option>Programado (192 h)</option>
              </select>
            </div>
            <div class="col">
              <label for="categoria_infra">Categor√≠a</label>
              <select id="categoria_infra" name="categoria_infra">
                <option value="">Seleccione...</option>
                <option>Equipos de c√≥mputo</option>
                <option>Muebles y enseres</option>
                <option>Equipos electr√≥nicos</option>
                <option>Equipos el√©ctricos</option>
                <option>Infraestructura y equipos de apoyo</option>
              </select>
            </div>
          </div>

          <label for="detalle_infra">Descripci√≥n breve (r√°pida)</label>
          <textarea id="detalle_infra" name="detalle_infra" placeholder="Ej: Cajonera suelta, luz intermitente..."></textarea>

          <div style="margin-top:8px;" class="small">Si desea detallar m√°s, utilice los campos de secci√≥n avanzada que aparecen abajo.</div>
        </div>

        <!-- EQUIPO M√âDICO: campos m√≠nimos y r√°pidos -->
        <div id="section_med" class="card-section" style="display:none;">
          <label class="small" style="font-weight:700">Secci√≥n: Equipo M√©dico (r√°pido)</label>

          <div class="row">
            <div class="col">
              <label for="equipo_medico_select">Equipo (Seleccione)</label>
              <select id="equipo_medico_select" name="equipo_medico_select">
                <option value="">Seleccione...</option>
                <!-- cargado din√°micamente -->
              </select>
            </div>
            <div class="col">
              <label for="sede_med">Sede</label>
              <select id="sede_med" name="sede_med">
                <option value="">Seleccione...</option>
                <option>Sede 1</option>
                <option>Sede 2</option>
                <option>Sede 3</option>
                <option>Sede 4</option>
                <option>Sede 5</option>
              </select>
            </div>
          </div>

          <div class="row">
            <div class="col">
              <label for="area_med">√Årea</label>
              <select id="area_med" name="area_med">
                <option value="">Seleccione...</option>
                <option>Administraci√≥n</option>
                <option>Consulta externa</option>
                <option>Enfermer√≠a</option>
                <option>Laboratorio</option>
                <option>Salud oral</option>
                <option>√Åreas comunes</option>
              </select>
            </div>
            <div class="col">
              <label for="ubicacion_med">Ubicaci√≥n espec√≠fica</label>
              <input type="text" id="ubicacion_med" name="ubicacion_med" placeholder='Ej: "Consultorio 101"'>
            </div>
          </div>

          <label for="danio_med">Da√±o / falla (breve)</label>
          <textarea id="danio_med" name="danio_med" placeholder="Ej: No enciende, alarma intermitente..."></textarea>

          <label for="prioridad_med" class="small">Prioridad del caso</label>
          <select id="prioridad_med" name="prioridad_med">
            <option value="">Seleccione...</option>
            <option>Urgente (6 h)</option>
            <option>Prioritario (48 h)</option>
            <option>Programado (192 h)</option>
          </select>
        </div>

        <!-- Opcional: m√°s detalle (mostrar si el usuario quiere) -->
        <div id="advancedToggle" style="margin-top:10px; display:flex; justify-content:flex-end;">
          <button type="button" id="showAdvanced" class="btn ghost">Mostrar opciones avanzadas</button>
        </div>

        <div id="advanced" class="card-section" style="display:none; margin-top:12px;">
          <label class="small" style="font-weight:700">Opciones avanzadas (si aplica)</label>

          <div class="row">
            <div class="col">
              <label for="infra_elemento">Infraestructura - elemento (si aplica)</label>
              <select id="infra_elemento" name="infra_elemento">
                <option value="">No aplica</option>
                <option>Puerta principal (chapa/bisagra)</option>
                <option>Luminaria</option>
                <option>Pared (resanar/pintar)</option>
                <option>Aire acondicionado</option>
                <option>Tanque de reserva</option>
                <option>Ascensor</option>
                <option>Otro...</option>
              </select>
            </div>
            <div class="col">
              <label for="mueble_ensenes">Muebles / enseres (si aplica)</label>
              <select id="mueble_ensenes" name="mueble_ensenes">
                <option value="">No aplica</option>
                <option>Escritorio</option>
                <option>Silla secretarial</option>
                <option>Cajonera</option>
                <option>Repisa</option>
                <option>Otro...</option>
              </select>
            </div>
          </div>

          <label for="detalle_avanzado">Descripci√≥n avanzada</label>
          <textarea id="detalle_avanzado" name="detalle_avanzado" placeholder="Informaci√≥n t√©cnica o complementaria..."></textarea>
        </div>

        <!-- adjuntos y extras -->
        <div class="card-section" style="margin-top:12px;">
          <label for="evidence">Adjuntar imagen (opcional)</label>
          <input type="file" id="evidence" name="evidence" accept="image/*">

          <div class="row" style="margin-top:12px;">
            <div class="col">
              <label for="responsable">Responsable (opcional)</label>
              <input type="text" id="responsable" name="responsable" placeholder="Nombre del responsable asignado">
            </div>
            <div class="col">
              <label for="estado">Estado inicial</label>
              <select id="estado" name="estado">
                <option value="">Seleccione...</option>
                <option>PENDIENTE</option>
                <option>EN PROCESO</option>
                <option>CERRADO</option>
              </select>
            </div>
          </div>
        </div>

        <!-- acciones -->
        <div class="controls" style="margin-top:14px;">
          <button type="submit" class="btn primary" id="submitBtn">Enviar Reporte</button>
          <button type="button" class="btn ghost" id="btnClear">Limpiar</button>
          <div style="flex:1;text-align:right" class="small">Dise√±ado por CorreQ ¬∑ IPS Interconsultas</div>
        </div>
      </form>
    </main>

    <footer class="footer">&copy; 2025 IPS Interconsultas</footer>
  </div>

  <!-- modal success -->
  <div id="modalExito" class="modal" role="dialog" aria-modal="true">
    <div class="box">
      <h3>‚úÖ Reporte enviado</h3>
      <p id="modalText">Su novedad ha sido registrada correctamente. ID: <strong id="modalID">-</strong></p>
      <div style="margin-top:12px;">
        <button id="closeModal" class="btn primary">Cerrar</button>
      </div>
    </div>
  </div>

  <!-- scripts -->
  <script src="https://cdn.jsdelivr.net/particles.js/2.0.0/particles.min.js"></script>
  <script>
    // Part√≠culas (sutil)
    particlesJS("particles-js", {
      "particles": {
        "number": { "value": 40 },
        "size": { "value": 2.5 },
        "move": { "speed": 1.6 },
        "line_linked": { "enable": true, "color": "#06b6d4" }
      }
    });

    // Listas (se usan para poblar selects largos si desea)
    const ubicaciones = [
      "Administrativo y √°reas com√∫nes","Atenci√≥n domiciliaria","Auditorio","Ba√±o discapacitados","Ba√±o hombres","Ba√±o mujeres",
      "Bodega enfermer√≠a 1","Bodega enfermer√≠a 2","Bodega insumos salud oral","Bodega laboratorio","Bodega mantenimiento",
      "Bodega PYP medicamentos","Bodega servicios generales","Bodega unidad 8","Bodega Vacunaci√≥n","Cafetin","Centro de acopio",
      "Citolog√≠a cervicouterina 1","Citolog√≠a cervicouterina 2","Coagulaci√≥n","Compras","Consultorio 101","Consultorio 102",
      "Consultorio 103","Consultorio 104","Consultorio 105","Consultorio 106","Consultorio 107","Consultorio 200",
      "Consultorio 201","Consultorio 202","Consultorio 203","Consultorio 204","Consultorio 205","Consultorio 206",
      "Consultorio 207","Consultorio 301","Consultorio 302","Consultorio 303","Consultorio 304","Consultorio 305",
      "Consultorio 306","Consultorio 307","Consultorio 308","Consultorio 309","Consultorio 310","Consultorio 311",
      "Consultorio 312","Consultorio L1","Consultorio L2","Consultorio L3","Consultorio L5","Consultorio L6","Consultorio L7",
      "Consultorio L8","Consultorio PAC","Consultorio S1","Consultorio S10","Consultorio S11","Consultorio S12","Consultorio S13",
      "Consultorio S14","Consultorio S15","Consultorio S16","Consultorio S17","Consultorio S2","Consultorio S3","Consultorio S4",
      "Consultorio S5","Consultorio S6","Consultorio S7","Consultorio S8","Consultorio S9","Consultorio101","Contingencia",
      "Contingencia Sede 1","Contingencia Sede 2","Crecimiento y desarrollo","Cuarto de aseo","Cuarto de planta","Cuarto de tanques",
      "Enfermer√≠a","Entrevista enfermera 1","Entrevista enfermera 2","Esterilizaci√≥n","Gerencia","Gesti√≥n documental","Immunolog√≠a",
      "Laboratorio","Lavado de material","Microbiolog√≠a","Microelisa","Microscop√≠a","M√≥dulos Autorizaciones","Modulo 1","Modulo 10",
      "Modulo 11","Modulo 12","Modulo 13","Modulo 14","Modulo 15","Modulo 2","Modulo 3","Modulo 4","Modulo 5","Modulo 6","Modulo 7",
      "Modulo 8","Modulo 9","M√≥dulo PAC","Mueble Instrumental general","Odontolog√≠a","Oficina compartida","Oficina contabilidad",
      "Oficna Coworking","Oficina de riesgo cardiovascular","Oficina l√≠der Consulta externa","Oficina L√≠der de Desarrollo Humano",
      "Oficina l√≠der PYM","Oficina l√≠der salud oral","Oficina SIAU","Pasillo","PBX","Procedimientos Enfermer√≠a 1",
      "Procedimientos Enfermer√≠a 2","Procedimientos menores","Puerta principal","Qu√≠mica","RCV","Sala de espera","Sala de lactancia",
      "Sala eda","Sala ERA","Salud oral","Seroteca","Toma de electrocardiograma","Toma de muestras ginecol√≥gicas",
      "Toma de muestras pedi√°tricas","Toma de muestras piso -1","Toma de muestras piso 1","Toma de muestras piso 2",
      "Toma de rayos x","Unidad odontol√≥gica 1","Unidad odontol√≥gica 10","Unidad odontol√≥gica 11","Unidad odontol√≥gica 2",
      "Unidad odontol√≥gica 3","Unidad odontol√≥gica 4","Unidad odontol√≥gica 5","Unidad odontol√≥gica 6","Unidad odontol√≥gica 7",
      "Unidad odontol√≥gica 8","Unidad odontol√≥gica 9","Vacunaci√≥n","Ba√±o privado","Cuarto de locker privado",
      "L√≠der de Calidad y Experiencia del Usuario"
    ];

    const equipos_medicos = [
      "Fonendoscopio","Tensi√≥metro","L√°mpara cuello de cisne","Tall√≠metro adulto","Equipo de √≥rganos","B√°scula tall√≠metro",
      "Diapas√≥n","Termohigr√≥metro","Negatoscopio","Contra Angulo","B√°scula digital","Micromotor","Unidad odontol√≥gica","Scaler",
      "L√°mpara de fotocurado","Pieza de alta","Pulsox√≠metro Pedi√°trico","Gluc√≥metro","Pulsox√≠metro","Tensi√≥metro Pedi√°trico",
      "Doppler fetal","Regulador de ox√≠geno","Infant√≥metro","Silla de ruedas","Pulsoximetro","B√°scula Pedi√°trica digital",
      "B√°scula de residuos","Pieza de alta","Pipeta autom√°tica","Fonendoscopio Pedi√°trico","Termometro","Termometro Digital",
      "Lampara de fotocurado","Term√≥metro","Desfibrilador","Electrocardi√≥grafo","Termo para trasporte de vacunas","Centr√≠fuga",
      "B√°scula Tallimetro","Nebulizador","Ba√±os","Tensi√≥metro de pared","Pesas Individua 20kg","Termohigrometro","Autoclave",
      "Microscopio","Pipeta mono canal","B√°scula Pedi√°trica","Dinam√≥metro 1","B√°scula digital","Ba√±o serol√≥gico","Equipo de rayos x",
      "Piano cuenta c√©lulas","Dinam√≥metro 2","Otoscopio","Congelador modelo WC-","Refrigerador modelo MK304","Electrocauterio",
      "Termo MVE","Agitador de Mazzini","Incubadora de controles biol√≥gicos","Term√≥metro infrarrojo","Horno de cultivo",
      "Monitor de signos vitales","Horno de secado","Pieza de alta velocidad","Monofilamento de diagnostico","Incubadora",
      "Termo de crioterapia","Tall√≠metro pedi√°trico","Dinam√≥metro","Nevera de vacunas caja t√©rmica"
    ];

    // Referencias DOM
    const ubicSelect = document.getElementById('ubicacion_infra');
    const equipoMedSelect = document.getElementById('equipo_medico_select');

    // Poblar selects largos
    function populateSelect(selectEl, arr) {
      arr.forEach((v,i) => {
        const opt = document.createElement('option');
        opt.value = v;
        opt.textContent = (i+1) + ". " + v;
        selectEl.appendChild(opt);
      });
    }

    document.addEventListener('DOMContentLoaded', () => {
      populateSelect(ubicSelect, ubicaciones);
      populateSelect(equipoMedSelect, equipos_medicos);

      // set fecha/hora/ID
      const now = new Date();
      document.getElementById('fecha').value = now.toLocaleDateString('es-CO');
      document.getElementById('hora').value = now.toLocaleTimeString('es-CO');
      const id = "REP-" + now.getFullYear() + "-" + String(now.getTime()).slice(-6);
      document.getElementById('idReporte').value = id;
      document.getElementById('idNote').textContent = id;

      // update progress
      setTimeout(updateProgress, 120);
    });

    // Mostrar secciones din√°micas y UX
    document.getElementById('tipo_reporte').addEventListener('change', (e) => {
      const v = e.target.value;
      document.getElementById('section_infra').style.display = v === 'infraestructura' ? 'block' : 'none';
      document.getElementById('section_med').style.display = v === 'equipo_medico' ? 'block' : 'none';
      updateProgress();
      if (v) { // scroll suave
        setTimeout(()=> {
          const el = v === 'infraestructura' ? document.getElementById('section_infra') : document.getElementById('section_med');
          if (el) el.scrollIntoView({behavior:'smooth', block:'start'});
        }, 120);
      }
    });

    // Mostrar opciones avanzadas
    document.getElementById('showAdvanced').addEventListener('click', () => {
      const adv = document.getElementById('advanced');
      adv.style.display = adv.style.display === 'block' ? 'none' : 'block';
      document.getElementById('showAdvanced').textContent = adv.style.display === 'block' ? 'Ocultar opciones avanzadas' : 'Mostrar opciones avanzadas';
    });

    // Limpiar formulario
    document.getElementById('btnClear').addEventListener('click', () => {
      if (confirm('¬øDesea limpiar el formulario?')) {
        const id = document.getElementById('idReporte').value;
        const f = document.getElementById('fecha').value;
        const h = document.getElementById('hora').value;
        document.getElementById('reporteForm').reset();
        document.getElementById('idReporte').value = id;
        document.getElementById('fecha').value = f;
        document.getElementById('hora').value = h;
        updateProgress();
      }
    });

    // Barra de progreso simple
    function updateProgress() {
      const inputs = Array.from(document.querySelectorAll('#reporteForm input[type="text"], #reporteForm input[type="email"], #reporteForm select, #reporteForm textarea'));
      const filled = inputs.filter(i => i.value && i.value.toString().trim() !== '').length;
      const percent = Math.round((filled / inputs.length) * 100);
      document.getElementById('progress').style.width = percent + '%';
    }
    document.getElementById('reporteForm').addEventListener('input', updateProgress);

    // Validaci√≥n b√°sica y env√≠o
    const scriptURL = "EL_ENLACE_QUE_LE_DA_LA_IMPLEMENTACI√ìN";

    const form = document.getElementById('reporteForm');
    const submitBtn = document.getElementById('submitBtn');

    form.addEventListener('submit', e => {
      e.preventDefault();

      // Validaci√≥n obligatorios m√≠nimos
      const nombre = document.getElementById('nombre').value.trim();
      const tipo = document.getElementById('tipo_reporte').value;

      if (!nombre) { invalidField('nombre'); return alert('Por favor ingrese el Nombre completo.'); }
      if (!tipo) { invalidField('tipo_reporte'); return alert('Seleccione si el reporte es de Infraestructura o Equipo m√©dico.'); }

      // Validaciones condicionales r√°pidas (solo las m√≠nimas)
      if (tipo === 'infraestructura') {
        if (!document.getElementById('area_infra').value) { invalidField('area_infra'); return alert('Seleccione el √°rea espec√≠fica.'); }
        if (!document.getElementById('ubicacion_infra').value) { invalidField('ubicacion_infra'); return alert('Seleccione la ubicaci√≥n espec√≠fica.'); }
        if (!document.getElementById('sede_infra').value) { invalidField('sede_infra'); return alert('Seleccione la sede.'); }
      } else {
        if (!document.getElementById('equipo_medico_select').value) { invalidField('equipo_medico_select'); return alert('Seleccione el equipo a reportar.'); }
        if (!document.getElementById('sede_med').value) { invalidField('sede_med'); return alert('Seleccione la sede del equipo.'); }
        if (!document.getElementById('area_med').value) { invalidField('area_med'); return alert('Seleccione el √°rea del equipo.'); }
      }

      // Preparar FormData
      const fd = new FormData(form);
      fd.append('timestamp', new Date().toISOString());

      // deshabilitar bot√≥n y mostrar estado
      submitBtn.disabled = true;
      submitBtn.textContent = 'Enviando...';

      fetch(scriptURL, { method: 'POST', body: fd })
        .then(res => {
          submitBtn.disabled = false;
          submitBtn.textContent = 'Enviar Reporte';

          // modal de √©xito
          const id = document.getElementById('idReporte').value;
          document.getElementById('modalID').textContent = id;
          document.getElementById('modalText').textContent = "Su novedad fue registrada correctamente. ID: " + id;
          document.getElementById('modalExito').style.display = 'flex';

          // reset ligero
          const idKeep = document.getElementById('idReporte').value;
          const fKeep = document.getElementById('fecha').value;
          const hKeep = document.getElementById('hora').value;
          form.reset();
          document.getElementById('idReporte').value = idKeep;
          document.getElementById('fecha').value = fKeep;
          document.getElementById('hora').value = hKeep;
          updateProgress();
        })
        .catch(err => {
          submitBtn.disabled = false;
          submitBtn.textContent = 'Enviar Reporte';
          alert('Error al enviar: ' + err.message);
        });
    });

    // invalid helper
    function invalidField(id) {
      const el = document.getElementById(id);
      if (!el) return;
      el.classList.add('invalid');
      setTimeout(()=> el.classList.remove('invalid'), 2200);
      el.focus();
    }

    // modal close
    document.getElementById('closeModal').addEventListener('click', () => {
      document.getElementById('modalExito').style.display = 'none';
    });
    document.getElementById('modalExito').addEventListener('click', (e) => {
      if (e.target === document.getElementById('modalExito')) document.getElementById('modalExito').style.display = 'none';
    });
  </script>
</body>
</html>

