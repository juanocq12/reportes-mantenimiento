<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>IPS Interconsultas - Solicitud de Mantenimiento</title>
<style>
*{box-sizing:border-box;margin:0;padding:0}
html,body{height:100%}
body{
  font-family: Arial, sans-serif;
  background: linear-gradient(180deg,#041428 0%, #061c36 60%);
  color:#fff;
  -webkit-font-smoothing:antialiased;
  padding:24px;
}
#particles-js { position: fixed; inset:0; z-index:-1; }
.wrap { max-width:980px;margin: 24px auto; }
.card {
  background: rgba(255,255,255,0.06);
  border-radius:12px;
  padding:18px;
  box-shadow: 0 8px 30px rgba(0,0,0,0.45);
  border: 1px solid rgba(6,182,212,0.06);
}
.header {
  display:flex;justify-content:space-between;align-items:center; gap:12px;
  margin-bottom:12px;
}
.brand h1 { color:#cfeefd; font-size:1.05rem; margin-bottom:4px; }
.brand p { color:#a9d9ef; font-size:0.85rem; margin:0; }
.row { display:flex; gap:12px; margin-top:8px; }
.col { flex:1; }
label {
  display:block; font-weight:700; color:#e6f7ff;
  margin-top:10px; font-size:0.95rem;
}
.input-plain {
  width:100%; padding:10px 12px;
  border-radius:8px; border:none;
  background:#0d274d; color:#fff; font-size:0.95rem;
  transition: background .12s ease, color .12s ease;
}
.input-plain.filled {
  background: #ffffff !important;
  color: #052233 !important;
}
textarea.input-plain { min-height:84px; resize:vertical; }
.controls { display:flex; gap:10px; align-items:center; margin-top:14px; }
.btn {
  padding:10px 16px; border-radius:999px;
  font-weight:700; cursor:pointer; border:none;
}
.btn.primary { background: linear-gradient(90deg,#06b6d4,#2563eb); color:#fff; }
.btn.ghost { background:transparent; color:#a8d9ef; border:1px solid rgba(255,255,255,0.06); }
.small { font-size:0.85rem; color:#9fc7e2; }
.modal {
  position:fixed; inset:0; display:none;
  background:rgba(0,0,0,0.6); z-index:80;
  align-items:center; justify-content:center;
}
.modal .box {
  background: rgba(2,30,50,0.98);
  padding:18px;border-radius:10px;color:#fff;
  max-width:520px; text-align:center;
}
.modal h3 { color:#06b6d4; margin-bottom:6px; }
.note-error { margin-top:12px; color:#ffd3a3; font-weight:700; display:none; }
@media (max-width:820px){ .row{flex-direction:column} }
</style>
</head>
<body>
<div id="particles-js"></div>
<div class="wrap">
  <div class="card">
    <div class="header">
      <div class="brand">
        <img src="Logo-Interconsultas-01b-500px.png" alt="logo" style="height:44px;margin-right:10px">
        <div>
          <h1>IPS Interconsultas</h1>
          <p>Solicitudes a Mantenimiento (locativo y biom√©dico)</p>
        </div>
      </div>
      <div style="text-align:right"><div class="small">Versi√≥n 1.0 </div></div>
    </div>
    <form id="reporteForm">
      <div class="row">
        <div class="col"><label>Fecha</label><input class="input-plain" type="text" id="fecha" name="fecha" readonly></div>
        <div class="col"><label>Hora</label><input class="input-plain" type="text" id="hora" name="hora" readonly></div>
        <div class="col"><label>ID</label><input class="input-plain" type="text" id="idReporte" name="idReporte" readonly></div>
      </div>
      <label>Nombre completo *</label>
      <input class="input-plain" type="text" id="nombre" name="nombre" placeholder="Ej: Juan Manuel Correa" required>
      <div class="row">
        <div class="col">
          <label>Correo (opcional)</label>
          <input class="input-plain" type="email" id="email" name="email" placeholder="ejemplo@interconsultas.com">
        </div>
        <div class="col">
          <label>El reporte se relaciona con *</label>
          <select class="input-plain" id="tipo_reporte" name="tipo_reporte" required>
            <option value="">Seleccione...</option>
            <option value="infraestructura">Infraestructura</option>
            <option value="equipo_medico">Equipo M√©dico</option>
          </select>
        </div>
      </div>
      <!-- Secci√≥n INFRA -->
      <div id="section_infra" style="display:none;margin-top:8px">
        <label>√Årea espec√≠fica *</label>
        <select class="input-plain" id="area_infra" name="area_infra">
          <option value="">Seleccione...</option>
          <option>Laboratorio</option><option>Enfermer√≠a</option>
          <option>Consulta externa</option><option>Odontolog√≠a</option>
          <option>Administraci√≥n</option><option>Atenci√≥n Al Usuario</option>
          <option>√Åreas Comunes</option>
        </select>
        <label>Sede *</label>
        <select class="input-plain" id="sede_infra" name="sede_infra">
          <option value="">Seleccione...</option>
          <option>Sede 1</option><option>Sede 2</option><option>Sede 3</option><option>Sede 4</option><option>Sede 5</option>
        </select>
        <label>Ubicaci√≥n espec√≠fica *</label>
        <select class="input-plain" id="ubicacion_infra" name="ubicacion_infra"><option value="">Seleccione...</option></select>
        <!-- üîç Campo de b√∫squeda agregado -->
        <input type="text" id="searchUbicacion" placeholder="Buscar ubicaci√≥n..." class="input-plain" style="margin-top:6px;">
        <div class="row">
          <div class="col">
            <label>Prioridad</label>
            <select class="input-plain" id="prioridad_infra" name="prioridad_infra">
              <option value="">Seleccione...</option>
              <option>Urgente (12 h)</option><option>Prioritario (48 h)</option><option>Programado (192 h)</option>
            </select>
          </div>
          <div class="col">
            <label>Categor√≠a</label>
            <select class="input-plain" id="categoria_infra" name="categoria_infra">
              <option value="">Seleccione...</option>
              <option>Equipos de c√≥mputo</option><option>Muebles y enseres</option>
              <option>Equipos electr√≥nicos y el√©ctricos</option>
              <option>Infraestructura y equipos de apoyo</option>
            </select>
          </div>
        </div>
        <label>Descripci√≥n (breve)</label>
        <textarea class="input-plain" id="detalle_infra" name="detalle_infra" placeholder="Ej: Grieta en pared, filtraci√≥n..."></textarea>
      </div>
      <!-- Secci√≥n MED -->
      <div id="section_med" style="display:none;margin-top:8px">
        <label>Equipo a reportar *</label>
        <select class="input-plain" id="equipo_medico_select" name="equipo_medico_select"><option value="">Seleccione...</option></select>
        <div class="row">
          <div class="col">
            <label>Sede *</label>
            <select class="input-plain" id="sede_med" name="sede_med">
              <option value="">Seleccione...</option>
              <option>Sede 1</option><option>Sede 2</option><option>Sede 3</option><option>Sede 4</option><option>Sede 5</option>
            </select>
          </div>
          <div class="col">
            <label>√Årea *</label>
            <select class="input-plain" id="area_med" name="area_med">
              <option value="">Seleccione...</option>
              <option>Administraci√≥n</option><option>Consulta externa</option><option>Enfermer√≠a</option>
              <option>Laboratorio</option><option>Salud oral</option><option>√Åreas comunes</option>
            </select>
          </div>
        </div>
        <label>Ubicaci√≥n espec√≠fica *</label>
        <input class="input-plain" type="text" id="ubicacion_med" name="ubicacion_med" placeholder='Ej: "Consultorio 101"'>
        <label>Da√±o / falla *</label>
        <textarea class="input-plain" id="danio_med" name="danio_med" placeholder="Describa el da√±o..."></textarea>
        <label>Prioridad</label>
        <select class="input-plain" id="prioridad_med" name="prioridad_med">
          <option value="">Seleccione...</option>
          <option>Urgente (12 h)</option><option>Prioritario (48 h)</option><option>Programado (192 h)</option>
        </select>
      </div>
      <div class="controls">
        <button type="submit" class="btn primary" id="submitBtn">Enviar Reporte</button>
        <button type="button" class="btn ghost" id="btnClear">Limpiar</button>
        <div style="flex:1;text-align:right" class="small">CorreQ ¬∑ IPS Interconsultas</div>
      </div>
      <div class="note-error" id="noteError">‚ö† Error de conexi√≥n. Revise el script o permisos.</div>
    </form>
  </div>
  <div class="modal" id="modalExito">
    <div class="box">
      <h3>‚úÖ Reporte enviado</h3>
      <p id="modalText">Su novedad fue registrada. ID: <span id="modalID">-</span></p>
      <div style="margin-top:12px"><button class="btn primary" id="cerrarModal">Cerrar</button></div>
    </div>
  </div>
</div>
<!-- particles -->
<script src="https://cdn.jsdelivr.net/particles.js/2.0.0/particles.min.js"></script>
<script>
const scriptURL = "https://script.google.com/macros/s/AKfycbxfVVdI0Dd-OSZMZhO2anRzXJ_G0VrU39SWXHENhTbxxpwyZa43qYAA-EqOaU_985Ck/exec";
particlesJS("particles-js", {
  particles: { number:{value:40}, size:{value:2.6}, move:{speed:1.6}, line_linked:{enable:true,color:"#06b6d4"} }
});
const ubicaciones = [
  "Administrativo y √°reas com√∫nes","Atenci√≥n domiciliaria","Auditorio","Ba√±o discapacitados","Ba√±o hombres","Ba√±o mujeres",
  "Bodega enfermer√≠a 1","Bodega enfermer√≠a 2","Bodega insumos salud oral","Bodega laboratorio","Bodega mantenimiento",
  "Bodega PYP medicamentos","Bodega servicios generales","Bodega unidad 8","Bodega Vacunaci√≥n","Cafetin","Centro de acopio",
  "Citolog√≠a cervicouterina 1","Citolog√≠a cervicouterina 2","Coagulaci√≥n","Compras","Consultorio 101","Consultorio 102",
  "Consultorio 103","Consultorio 104","Consultorio 105","Consultorio 106","Consultorio 107","Consultorio 200",
  "Consultorio 201","Consultorio 202","Consultorio 203","Consultorio 204","Consultorio 205","Consultorio 206",
  "Consultorio 207","Consultorio 301","Consultorio 302","Consultorio 303","Consultorio 304","Consultorio 305",
  "Consultorio 306","Consultorio 307","Consultorio 308","Consultorio 309","Consultorio 310","Consultorio 311",
  "Consultorio 312","Consultorio L1","Consultorio L2","Consultorio L3","Consultorio L5","Consultorio L6","Consultorio L7",
  "Consultorio L8","Consultorio PAC","Consultorio S1","Consultorio S10","Consultorio S11","Consultorio S12","Consultorio S13",
  "Consultorio S14","Consultorio S15","Consultorio S16","Consultorio S17","Consultorio S2","Consultorio S3","Consultorio S4",
  "Consultorio S5","Consultorio S6","Consultorio S7","Consultorio S8","Consultorio S9","Consultorio101","Contingencia",
  "Contingencia Sede 1","Contingencia Sede 2","Crecimiento y desarrollo","Cuarto de aseo","Cuarto de planta","Cuarto de tanques",
  "Enfermer√≠a","Entrevista enfermera 1","Entrevista enfermera 2","Esterilizaci√≥n","Gerencia","Gesti√≥n documental","Inmunolog√≠a",
  "Laboratorio","Lavado de material","Microbiolog√≠a","Microelisa","Microscop√≠a","M√≥dulos Autorizaciones","Modulo 1","Modulo 10",
  "Modulo 11","Modulo 12","Modulo 13","Modulo 14","Modulo 15","Modulo 2","Modulo 3","Modulo 4","Modulo 5","Modulo 6","Modulo 7",
  "Modulo 8","Modulo 9","M√≥dulo PAC","Mueble Instrumental general","Odontolog√≠a","Oficina compartida","Oficina contabilidad",
  "Oficina Coworking","Oficina de riesgo cardiovascular","Oficina l√≠der Consulta externa","Oficina L√≠der de Desarrollo Humano",
  "Oficina l√≠der PYM","Oficina l√≠der salud oral","Oficina SIAU","Pasillo","PBX","Procedimientos Enfermer√≠a 1",
  "Procedimientos Enfermer√≠a 2","Procedimientos menores","Puerta principal","Qu√≠mica","RCV","Sala de espera","Sala de lactancia",
  "Sala eda","Sala ERA","Salud oral","Seroteca","Toma de electrocardiograma","Toma de muestras ginecol√≥gicas",
  "Toma de muestras pedi√°tricas","Toma de muestras piso -1","Toma de muestras piso 1","Toma de muestras piso 2",
  "Toma de rayos x","Unidad odontol√≥gica 1","Unidad odontol√≥gica 10","Unidad odontol√≥gica 11","Unidad odontol√≥gica 2",
  "Unidad odontol√≥gica 3","Unidad odontol√≥gica 4","Unidad odontol√≥gica 5","Unidad odontol√≥gica 6","Unidad odontol√≥gica 7",
  "Unidad odontol√≥gica 8","Unidad odontol√≥gica 9","Vacunaci√≥n","Ba√±o privado","Cuarto de locker privado","L√≠der de Calidad y Experiencia del Usuario","Otro"
];
const equipos_medicos = [
  "Fonendoscopio","Tensi√≥metro","L√°mpara cuello de cisne","Tall√≠metro adulto","Equipo de √≥rganos","B√°scula tall√≠metro",
  "Diapas√≥n","Termohigr√≥metro","Negatoscopio","Contra √Ångulo","B√°scula digital","Micromotor","Unidad odontol√≥gica","Scaler",
  "L√°mpara de fotocurado","Pieza de alta","Pulsox√≠metro Pedi√°trico","Gluc√≥metro","Pulsox√≠metro","Tensi√≥metro Pedi√°trico",
  "Doppler fetal","Regulador de ox√≠geno","Infant√≥metro","Silla de ruedas","Pulsox√≠metro","B√°scula Pedi√°trica digital",
  "B√°scula de residuos","Pipeta autom√°tica","Term√≥metro","Desfibrilador","Electrocardi√≥grafo","Termo para transporte de vacunas",
  "Centr√≠fuga","Nebulizador","Autoclave","Microscopio","Monitor de signos vitales","Refrigerador modelo MK304","Incubadora","Otro"
];
const ubicSelect = document.getElementById('ubicacion_infra');
const equipoSelect = document.getElementById('equipo_medico_select');
const searchUbicacion = document.getElementById('searchUbicacion');
const form = document.getElementById('reporteForm');
const noteError = document.getElementById('noteError');

document.addEventListener('DOMContentLoaded', () => {
  ubicaciones.forEach((v,i) => ubicSelect.add(new Option((i+1)+". "+v, v)));
  equipos_medicos.forEach((v,i) => equipoSelect.add(new Option((i+1)+". "+v, v)));
  actualizarCamposTemporales();
  const fields = form.querySelectorAll('input.input-plain, select.input-plain, textarea.input-plain');
  fields.forEach(f => {
    updateFilledClass(f);
    f.addEventListener('input', ()=> updateFilledClass(f));
    f.addEventListener('change', ()=> updateFilledClass(f));
  });
});

// üîç B√∫squeda de ubicaciones
searchUbicacion.addEventListener('input', () => {
  const term = searchUbicacion.value.toLowerCase();
  ubicSelect.innerHTML = '<option value="">Seleccione...</option>';
  ubicaciones
    .filter(u => u.toLowerCase().includes(term))
    .forEach((v,i) => ubicSelect.add(new Option((i+1)+". "+v, v)));
});

function actualizarCamposTemporales(){
  const now = new Date();
  document.getElementById('fecha').value = now.toLocaleDateString('es-CO');
  document.getElementById('hora').value = now.toLocaleTimeString('es-CO',{hour:'2-digit',minute:'2-digit'});
  document.getElementById('idReporte').value = "R" + now.getFullYear().toString().slice(-2) + (now.getMonth()+1).toString().padStart(2,'0') + now.getDate().toString().padStart(2,'0') + "-" + now.getHours().toString().padStart(2,'0') + now.getMinutes().toString().padStart(2,'0');
}
function updateFilledClass(el){ el.classList.toggle('filled', el.value.trim()!==''); }

document.getElementById('tipo_reporte').addEventListener('change', e=>{
  document.getElementById('section_infra').style.display = e.target.value==="infraestructura"?"block":"none";
  document.getElementById('section_med').style.display = e.target.value==="equipo_medico"?"block":"none";
});

form.addEventListener('submit', e=>{
  e.preventDefault();
  const btn = document.getElementById('submitBtn');
  btn.disabled=true; btn.textContent="Enviando...";
  fetch(scriptURL,{method:'POST',body:new FormData(form)})
  .then(res=>res.text())
  .then(()=>{ 
    document.getElementById('modalID').textContent=document.getElementById('idReporte').value;
    document.getElementById('modalExito').style.display='flex';
    form.reset(); actualizarCamposTemporales();
    document.querySelectorAll('.input-plain').forEach(f=>f.classList.remove('filled'));
    btn.disabled=false; btn.textContent="Enviar Reporte";
  })
  .catch(()=>{ noteError.style.display='block'; btn.disabled=false; btn.textContent="Enviar Reporte"; });
});

document.getElementById('cerrarModal').addEventListener('click',()=>{ document.getElementById('modalExito').style.display='none'; });
document.getElementById('btnClear').addEventListener('click',()=>{ form.reset(); actualizarCamposTemporales(); document.querySelectorAll('.input-plain').forEach(f=>f.classList.remove('filled')); });
</script>
</body>
</html>


